<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Administrar Asistencia INGEMAT</title>
    <link rel="stylesheet" href="../css/admin.css" />
    <link rel="stylesheet" href="../css/admin-forms.css" />
    <link rel="stylesheet" href="../css/admin-views.css" />
    <link rel="stylesheet" href="../css/admin-whatsapp.css" />
    <link rel="stylesheet" href="../css/admin-whatsapp-rules.css" />
    <link rel="stylesheet" href="../css/admin-responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="logo-ingemat">
        <a href="/"
          ><img href="/" src="../img/Logo 1x4 b&w.svg" alt="Logo INGEMAT"
        /></a>
      </div>
      <div class="nav-links">
        <button class="nav-button active" id="btn-vista-inicio">
          <i class="bi bi-house-door-fill"></i> INICIO
        </button>
        <button class="nav-button" id="btn-vista-usuarios">
          <i class="bi bi-people-fill"></i> USUARIOS
        </button>
        <button class="nav-button" id="btn-vista-whatsapp">
          <i class="bi bi-whatsapp"></i> WHATSAPP
        </button>
        <button class="nav-button" id="btn-vista-info">
          <i class="bi bi-info-circle-fill"></i> INFO
        </button>
        <button id="btn-logout" title="Cerrar Sesión">
          <i class="bi bi-box-arrow-right"></i>
        </button>
      </div>
    </nav>

    <div class="container">
      <div class="hero-header">
        <h1>PANEL DE CONTROL</h1>
        <div class="hero-sub">
          Resumen rápido • Usuarios activos • Últimos archivos
        </div>
      </div>

      <div id="vista-principal" class="vista-content">
        <div class="admin-grid">
          <section id="horarios-section">
            <h2><i class="bi bi-clock-fill"></i> CONFIGURAR HORARIOS</h2>
            <form id="form-horarios">
              <div
                class="form-group"
                style="margin-bottom: 15px; flex-wrap: wrap"
              >
                <label
                  for="horarios-ciclo-select"
                  style="font-weight: bold; font-size: 1rem"
                  >Configurar horarios para:</label
                >
                <select id="horarios-ciclo-select" required>
                  <option value="">Cargando ciclos...</option>
                </select>
                <small
                  style="
                    color: #555;
                    font-size: 0.85rem;
                    width: 100%;
                    margin-top: 5px;
                  "
                  >El horario 'Default' se usa si un ciclo no tiene horario
                  propio.</small
                >
              </div>

              <div>
                <div class="time-picker-group">
                  <label for="entrada-manana-hr">Mañana - Entrada:</label>
                  <div class="time-picker-inputs">
                    <select
                      id="entrada-manana-hr"
                      aria-label="Hora de entrada mañana"
                      required
                    ></select>
                    <span>:</span>
                    <select
                      id="entrada-manana-min"
                      aria-label="Minuto de entrada mañana"
                      required
                    ></select>
                    <select
                      id="entrada-manana-ampm"
                      aria-label="AM/PM de entrada mañana"
                      required
                    >
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                  </div>
                </div>

                <div class="time-picker-group">
                  <label for="tolerancia-manana-hr">Mañana - Tolerancia:</label>
                  <div class="time-picker-inputs">
                    <select
                      id="tolerancia-manana-hr"
                      aria-label="Hora de tolerancia mañana"
                      required
                    ></select>
                    <span>:</span>
                    <select
                      id="tolerancia-manana-min"
                      aria-label="Minuto de tolerancia mañana"
                      required
                    ></select>
                    <select
                      id="tolerancia-manana-ampm"
                      aria-label="AM/PM de tolerancia mañana"
                      required
                    >
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                  </div>
                </div>
              </div>
              <p id="summary-manana" class="schedule-summary"></p>
              <div>
                <div class="time-picker-group">
                  <label for="entrada-tarde-hr">Tarde - Entrada:</label>
                  <div class="time-picker-inputs">
                    <select
                      id="entrada-tarde-hr"
                      aria-label="Hora de entrada tarde"
                      required
                    ></select>
                    <span>:</span>
                    <select
                      id="entrada-tarde-min"
                      aria-label="Minuto de entrada tarde"
                      required
                    ></select>
                    <select
                      id="entrada-tarde-ampm"
                      aria-label="AM/PM de entrada tarde"
                      required
                    >
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                  </div>
                </div>

                <div class="time-picker-group">
                  <label for="tolerancia-tarde-hr">Tarde - Tolerancia:</label>
                  <div class="time-picker-inputs">
                    <select
                      id="tolerancia-tarde-hr"
                      aria-label="Hora de tolerancia tarde"
                      required
                    ></select>
                    <span>:</span>
                    <select
                      id="tolerancia-tarde-min"
                      aria-label="Minuto de tolerancia tarde"
                      required
                    ></select>
                    <select
                      id="tolerancia-tarde-ampm"
                      aria-label="AM/PM de tolerancia tarde"
                      required
                    >
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                  </div>
                </div>
              </div>
              <p id="summary-tarde" class="schedule-summary"></p>
              <button type="submit">
                <i class="bi bi-save-fill"></i> GUARDAR HORARIOS
              </button>
            </form>
            <div id="msg-horarios"></div>
          </section>
          <section id="gestion-ciclos-section">
            <h2><i class="bi bi-calendar-range"></i> GESTIÓN DE CICLOS</h2>
            <div id="ciclos-list-container">
              <ul id="ciclos-list" class="lista-gestion-ciclos"></ul>
            </div>
            <form id="form-agregar-ciclo">
              <input
                type="text"
                id="nuevo-ciclo-nombre"
                placeholder="Nombre del nuevo ciclo"
                required
                oninput="this.value = this.value.toUpperCase()"
              />
              <button type="submit">
                <i class="bi bi-plus-circle-fill"></i> AGREGAR CICLO
              </button>
            </form>
            <div id="msg-ciclos"></div>
          </section>
          <section id="agregar-usuario-section">
            <h2><i class="bi bi-person-plus-fill"></i> AGREGAR USUARIO</h2>
            <form id="form-agregar">
              <input
                type="text"
                id="codigo"
                placeholder="Código"
                required
                style="text-transform: uppercase"
              />
              <div style="display: flex; gap: 8px; flex-wrap: wrap">
                <input
                  type="text"
                  id="nombre"
                  placeholder="Nombre (ej: Juan Carlos)"
                  required
                  style="flex: 1"
                />
                <input
                  type="text"
                  id="apellido"
                  placeholder="Apellido (ej: Pérez)"
                  required
                  style="flex: 1"
                />
              </div>
              <select id="rol" required>
                <option value="">Selecciona rol</option>
                <option value="estudiante">Estudiante</option>
                <option value="docente">Docente</option>
              </select>
              <select id="turno" required>
                <option value="">Selecciona turno</option>
                <option value="mañana">Mañana</option>
                <option value="tarde">Tarde</option>
              </select>
              <select id="ciclo" required>
                <option value="">Cargando ciclos...</option>
              </select>

              <div id="dias-asistencia-selector">
                <label>Días de Asistencia:</label>
                <div class="day-buttons-container">
                  <button type="button" class="day-btn active" data-day="L">
                    L
                  </button>
                  <button type="button" class="day-btn active" data-day="M">
                    M
                  </button>
                  <button type="button" class="day-btn active" data-day="MI">
                    Mi
                  </button>
                  <button type="button" class="day-btn active" data-day="J">
                    J
                  </button>
                  <button type="button" class="day-btn active" data-day="V">
                    V
                  </button>
                  <button type="button" class="day-btn active" data-day="S">
                    S
                  </button>
                  <button type="button" class="day-btn" data-day="D">D</button>
                </div>
              </div>
              <button type="submit">
                <i class="bi bi-check-lg"></i> AGREGAR
              </button>
              <div id="msg-agregar-usuario"></div>
            </form>
          </section>

          <section id="archivos-excel-section">
            <h2>
              <i class="bi bi-file-earmark-excel-fill"></i> DESCARGAR ARCHIVOS
            </h2>
            <div id="archivos-excel"></div>
          </section>

          <section id="gestion-acceso-section">
            <h2><i class="bi bi-key-fill"></i> GESTIÓN DE ACCESO</h2>
            <form id="form-password">
              <input
                type="password"
                id="nueva-password"
                placeholder="Nueva contraseña"
                required
              />
              <button type="submit">
                <i class="bi bi-pencil-square"></i> CAMBIAR CONTRASEÑA
              </button>
            </form>
            <div id="msg-password"></div>
          </section>

          <section id="justificar-falta-section">
            <h2>
              <i class="bi bi-patch-check-fill"></i> Justificar Inasistencia
            </h2>
            <form id="form-justificar-falta">
              <label for="justificar-fecha">Fecha de la falta:</label>
              <input type="date" id="justificar-fecha" required />

              <div class="autocomplete-container">
                <label for="justificar-usuario-filtro"
                  >Buscar Alumno o Docente:</label
                >
                <input
                  type="text"
                  id="justificar-usuario-filtro"
                  placeholder="Escribe un nombre para buscar..."
                  autocomplete="off"
                />
                <input type="hidden" id="justificar-alumno-hidden" required />

                <div
                  class="autocomplete-items"
                  id="justificar-resultados"
                ></div>
              </div>
              <button type="submit">
                <i class="bi bi-check-lg"></i> JUSTIFICAR
              </button>
            </form>
            <div id="msg-justificar-falta" class="form-message"></div>
          </section>
        </div>
      </div>

      <div
        id="vista-usuarios-completa"
        class="vista-content"
        style="display: none"
      >
        <h2 class="sub-header">
          <i class="bi bi-card-list"></i> LISTADO COMPLETO DE USUARIOS
        </h2>
        <div id="vista-usuarios-list" class="accordion-container"></div>
      </div>

      <div id="vista-whatsapp" class="vista-content" style="display: none">
        <h2 class="sub-header">
          <i class="bi bi-whatsapp"></i> CONFIGURACIÓN DE WHATSAPP
        </h2>

        <div
          id="whatsapp-qr-container"
          style="display: none; text-align: center; padding: 20px"
        >
          <h3><i class="bi bi-qr-code-scan"></i> Iniciar Sesión</h3>
          <p id="whatsapp-qr-message" style="margin-bottom: 15px">
            Se necesita iniciar sesión. Escanea el código QR con tu teléfono.
          </p>
          <canvas
            id="whatsapp-qr-canvas"
            style="
              border: 1px solid #ddd;
              padding: 10px;
              border-radius: 8px;
              background: white;
            "
          ></canvas>
          <p style="font-size: 0.9rem; color: #555; margin-top: 15px">
            La página se actualizará automáticamente una vez que inicies sesión.
          </p>

          <div
            style="
              margin-top: 20px;
              border-top: 1px solid #eee;
              padding-top: 20px;
            "
          >
            <p style="font-size: 0.9rem; color: #666; margin-bottom: 10px">
              ¿No aparece el QR o la sesión está bloqueada?
            </p>
            <button
              id="btn-force-whatsapp-restart"
              class="btn-delete-rule"
              style="
                background-color: #ffc107;
                color: #333;
                border: none;
                padding: 10px 15px;
                border-radius: 5px;
                font-family: var(--font-body);
                text-transform: uppercase;
                letter-spacing: 1px;
              "
            >
              <i class="bi bi-exclamation-triangle-fill"></i> Forzar Reinicio
            </button>
            <div
              id="msg-force-restart"
              class="form-message"
              style="margin-top: 10px"
            ></div>
          </div>
        </div>

        <div id="whatsapp-config-content" style="display: none">
          <div
            id="unsaved-changes-alert"
            class="unsaved-alert sticky"
            style="display: none"
          >
            <i class="bi bi-exclamation-triangle-fill"></i> Tienes cambios sin
            guardar en esta sección.
            <button id="btn-jump-to-save" title="Ir a Guardar">
              <i class="bi bi-arrow-down-circle"></i>
            </button>
          </div>

          <div class="whatsapp-status-section">
            <h3>
              Estado de Conexión:
              <span id="whatsapp-status-indicator" class="status-disconnected"
                >Desconectado</span
              >
            </h3>
            <p id="whatsapp-status-message">Intentando conectar...</p>
            <button id="btn-refresh-whatsapp-status" title="Refrescar Estado">
              <i class="bi bi-arrow-clockwise"></i>
            </button>
          </div>

          <section class="whatsapp-config-section">
            <h3><i class="bi bi-toggles"></i> Controles de Activación</h3>

            <div class="toggle-switch-container master-toggle">
              <label class="switch">
                <input type="checkbox" id="whatsapp-enabled-general" />
                <span class="slider round"></span>
              </label>
              <span id="whatsapp-enabled-general-label"
                >Activación General de WhatsApp</span
              >
            </div>

            <hr class="divider" />

            <div class="toggle-switch-container">
              <label class="switch">
                <input type="checkbox" id="student-notifications-toggle" />
                <span class="slider round"></span>
              </label>
              <span id="student-notifications-label"
                >Notificaciones de Estudiantes (al registrar)</span
              >
            </div>

            <div class="toggle-switch-container">
              <label class="switch">
                <input type="checkbox" id="teacher-notifications-toggle" />
                <span class="slider round"></span>
              </label>
              <span id="teacher-notifications-label"
                >Notificaciones de Docentes (al registrar)</span
              >
            </div>

            <div class="toggle-switch-container">
              <label class="switch">
                <input type="checkbox" id="report-enabled-toggle" />
                <span class="slider round"></span>
              </label>
              <span id="report-enabled-label">Reporte por Imagen (Manual)</span>
            </div>
          </section>

          <section class="whatsapp-config-section">
            <h3>
              <i class="bi bi-people-fill"></i> Config. Notificaciones de
              Estudiantes
            </h3>
            <div id="student-rules-list">
              <p>Cargando reglas...</p>
            </div>
            <div class="add-rule-form">
              <h4>
                <i class="bi bi-plus-circle-fill"></i> Agregar Nueva Regla
              </h4>
              <div class="form-grid-whatsapp">
                <select id="rule-ciclo" required>
                  <option value="">Selecciona Ciclo</option>
                </select>
                <select id="rule-turno" required>
                  <option value="">Selecciona Turno</option>
                  <option value="mañana">Mañana</option>
                  <option value="tarde">Tarde</option>
                </select>
                <select id="rule-target-type" required>
                  <option value="group">Enviar a Grupo</option>
                  <option value="number">Enviar a Número</option>
                </select>

                <div id="rule-group-field" class="autocomplete-container">
                  <label for="rule-group-filtro">Grupo de WhatsApp:</label>
                  <input
                    type="text"
                    id="rule-group-filtro"
                    placeholder="Buscar grupo por nombre..."
                    autocomplete="off"
                  />
                  <input type="hidden" id="rule-group-hidden" />
                  <div
                    class="autocomplete-items"
                    id="rule-group-resultados"
                  ></div>
                </div>
                <div id="rule-number-field" style="display: none">
                  <label for="rule-number-input"
                    >Número (ej: 519XXXXXXXX):</label
                  >
                  <input
                    type="tel"
                    id="rule-number-input"
                    placeholder="519..."
                  />
                </div>
              </div>
              <button id="btn-add-student-rule">
                <i class="bi bi-plus"></i> Agregar Regla
              </button>
              <div id="msg-add-rule" class="form-message"></div>
            </div>
          </section>

          <section class="whatsapp-config-section">
            <h3>
              <i class="bi bi-person-badge-fill"></i> Config. Notificaciones de
              Docentes
            </h3>
            <p
              style="
                font-size: 0.9rem;
                color: #555;
                margin-top: -10px;
                margin-bottom: 15px;
              "
            >
              Define un único destino (grupo o número) para todas las
              notificaciones de docentes.
            </p>
            <div class="form-grid-whatsapp">
              <select id="teacher-target-type" required>
                <option value="number">Enviar a Número</option>
                <option value="group">Enviar a Grupo</option>
              </select>

              <div
                id="teacher-group-field"
                class="autocomplete-container"
                style="display: none"
              >
                <label for="teacher-group-filtro">Grupo de WhatsApp:</label>
                <input
                  type="text"
                  id="teacher-group-filtro"
                  placeholder="Buscar grupo por nombre..."
                  autocomplete="off"
                />
                <input type="hidden" id="teacher-group-hidden" />
                <div
                  class="autocomplete-items"
                  id="teacher-group-resultados"
                ></div>
              </div>
              <div id="teacher-number-field">
                <label for="teacher-number-input"
                  >Número (ej: 519XXXXXXXX):</label
                >
                <input
                  type="tel"
                  id="teacher-number-input"
                  placeholder="519... (dejar vacío para no enviar)"
                />
              </div>
            </div>
          </section>

          <section class="whatsapp-config-section">
            <h3>
              <i class="bi bi-images"></i> Config. Reporte por Imagen (Manual)
            </h3>
            <p
              style="
                font-size: 0.9rem;
                color: #555;
                margin-top: -10px;
                margin-bottom: 15px;
              "
            >
              Configura los grupos de destino para enviar el reporte de
              asistencia manualmente.
            </p>

            <h4><i class="bi bi-geo-alt-fill"></i> Destinos del Reporte</h4>
            <div id="report-rules-list">
              <p>No hay destinos configurados.</p>
            </div>

            <div class="add-rule-form">
              <h5
                style="
                  margin-top: 1.5rem;
                  margin-bottom: 1rem;
                  border-top: 1px solid var(--white2);
                  padding-top: 1rem;
                "
              >
                <i class="bi bi-plus-circle-fill"></i> Agregar Destino de
                Reporte
              </h5>
              <div class="form-grid-whatsapp">
                <select id="report-rule-ciclo" required>
                  <option value="">Selecciona Ciclo</option>
                </select>

                <div id="report-rule-turno-container">
                  <label for="report-rule-turno" class="sr-only"
                    >Selecciona Turno</label
                  >
                  <select id="report-rule-turno" required>
                    <option value="">Selecciona Turno</option>
                    <option value="mañana">Mañana</option>
                    <option value="tarde">Tarde</option>
                  </select>
                </div>
                <div
                  id="report-rule-group-field"
                  class="autocomplete-container"
                >
                  <label for="report-rule-group-filtro"
                    >Grupo de WhatsApp:</label
                  >
                  <input
                    type="text"
                    id="report-rule-group-filtro"
                    placeholder="Buscar grupo por nombre..."
                    autocomplete="off"
                  />
                  <input type="hidden" id="report-rule-group-hidden" />
                  <div
                    class="autocomplete-items"
                    id="report-rule-resultados"
                  ></div>
                </div>
              </div>
              <button id="btn-add-report-rule">
                <i class="bi bi-plus"></i> Agregar Destino
              </button>
              <div id="msg-add-report-rule" class="form-message"></div>
            </div>
          </section>

          <div class="whatsapp-save-section" id="whatsapp-save-section">
            <button id="btn-save-whatsapp-config">
              <i class="bi bi-save-fill"></i> GUARDAR CONFIGURACIÓN WHATSAPP
            </button>
            <div id="msg-whatsapp-config" class="form-message"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="preview-modal" class="modal">
      <div class="modal-content">
        <span class="close-btn" id="close-preview">&times;</span>
        <h2>VISTA PREVIA DEL ARCHIVO</h2>
        <h3 id="preview-filename" style="margin-bottom: 15px"></h3>
        <div id="preview-tabs" class="preview-tab-container"></div>
        <div id="preview-content" class="preview-content-area"></div>
      </div>
    </div>
    <div id="barcode-modal" class="modal">
      <div class="modal-content">
        <span class="close-btn" id="close-barcode">&times;</span>
        <h2 id="carnet-title">Carnet de Usuario</h2>
        <p id="barcode-text" style="font-weight: 600; margin-bottom: 10px"></p>
        <div style="text-align: center; margin-bottom: 10px">
          <canvas
            id="barcode-canvas"
            width="320"
            height="480"
            style="
              border: 1px solid #eee;
              border-radius: 8px;
              background: #fff;
              width: 320px;
              height: 480px;
            "
          ></canvas>
        </div>
        <div style="text-align: center">
          <a id="download-barcode" class="btn btn-download">
            <i class="bi bi-download"></i> Descargar PNG
          </a>
        </div>
        <div style="margin-top: 12px; text-align: center">
          <label
            for="barcode-notes"
            style="display: block; margin-bottom: 6px; font-weight: 600"
            >Notas (tel. emergencia, salidas, etc.)</label
          >
          <textarea
            id="barcode-notes"
            placeholder="Agregar notas para este usuario..."
            style="
              width: 80%;
              height: 80px;
              padding: 8px;
              border-radius: 6px;
              border: 1px solid #ddd;
            "
          ></textarea>
          <div style="margin-top: 8px">
            <button id="save-barcode-notes" class="btn btn-primary">
              <i class="bi bi-save"></i> Guardar notas
            </button>
            <span
              id="barcode-notes-msg"
              style="margin-left: 10px; color: #666"
            ></span>
          </div>
        </div>
      </div>
    </div>

    <div id="edit-user-modal" class="modal">
      <div class="modal-content" style="max-width: 700px">
        <span class="close-btn" id="close-edit-modal">&times;</span>
        <h2><i class="bi bi-pencil-square"></i> EDITAR USUARIO</h2>
        <form id="form-editar">
          <input type="hidden" id="edit-original-codigo" />

          <input
            type="text"
            id="edit-codigo"
            placeholder="Código"
            required
            style="text-transform: uppercase"
          />
          <div style="display: flex; gap: 8px; flex-wrap: wrap">
            <input
              type="text"
              id="edit-nombre"
              placeholder="Nombre"
              required
              style="flex: 1"
            />
            <input
              type="text"
              id="edit-apellido"
              placeholder="Apellido"
              required
              style="flex: 1"
            />
          </div>
          <select id="edit-rol" required>
            <option value="">Selecciona rol</option>
            <option value="estudiante">Estudiante</option>
            <option value="docente">Docente</option>
          </select>
          <select id="edit-turno" required>
            <option value="">Selecciona turno</option>
            <option value="mañana">Mañana</option>
            <option value="tarde">Tarde</option>
          </select>
          <select id="edit-ciclo" required>
            </select>

          <div id="edit-dias-asistencia-selector">
            <label>Días de Asistencia:</label>
            <div class="day-buttons-container">
              <button type="button" class="day-btn" data-day="L">L</button>
              <button type="button" class="day-btn" data-day="M">M</button>
              <button type="button" class="day-btn" data-day="MI">Mi</button>
              <button type="button" class="day-btn" data-day="J">J</button>
              <button type="button" class="day-btn" data-day="V">V</button>
              <button type="button" class="day-btn" data-day="S">S</button>
              <button type="button" class="day-btn" data-day="D">D</button>
            </div>
          </div>
          <button type="submit">
            <i class="bi bi-save-fill"></i> GUARDAR CAMBIOS
          </button>
          <div id="msg-editar-usuario" class="form-message"></div>
        </form>
      </div>
    </div>
    <div id="vista-info" class="vista-content" style="display: none">
      <h2 class="sub-header">
        <i class="bi bi-info-square-fill"></i> INFO - Ciclos y Carrusel
      </h2>

      <section id="info-section">
        <div
          id="info-controls"
          style="
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 12px;
          "
        >
          <button id="btn-add-ciclo" class="btn-pill btn-primary">
            Agregar Ciclo
          </button>
          <span style="color: #666; font-size: 0.95rem"
            >Admin: crea/edita los ciclos mostrados en la web pública.</span
          >
        </div>

        <div id="info-list"></div>

        <div id="ciclo-form-modal" class="modal">
          <div class="modal-content ciclo-modal" style="max-width: 650px">
            <span class="close-btn" id="close-ciclo-form">&times;</span>
            <h2 id="ciclo-form-title" class="ciclo-form-header">
              Agregar Ciclo
            </h2>
            <form id="ciclo-form" class="ciclo-form">
              <div class="form-group">
                <label for="ciclo-titulo">Título del Ciclo</label>
                <input
                  type="text"
                  id="ciclo-titulo"
                  placeholder="ej: Matemáticas 2025"
                  required
                />
              </div>
              <div class="form-group">
                <label for="ciclo-slug">Slug (URL amigable)</label>
                <input
                  type="text"
                  id="ciclo-slug"
                  placeholder="ej: matematica-2025"
                  required
                />
              </div>
              <div class="form-group">
                <label for="ciclo-descripcion">Descripción</label>
                <textarea
                  id="ciclo-descripcion"
                  placeholder="Describe brevemente el ciclo..."
                  rows="3"
                ></textarea>
              </div>
              <div class="form-group">
                <label for="ciclo-beneficios">Beneficios</label>
                <textarea
                  id="ciclo-beneficios"
                  placeholder="Cada línea es un beneficio (ej: Certificado oficial)&#10;Aprendizaje práctico&#10;Tutorías personalizadas"
                  rows="4"
                ></textarea>
              </div>
              <div class="form-group">
                <label for="ciclo-price">Precio Actual (S/)</label>
                <input
                  type="number"
                  id="ciclo-price"
                  placeholder="ej: 299.00"
                  step="0.01"
                />
              </div>
              <div class="form-group form-checkbox">
                <label>
                  <input type="checkbox" id="ciclo-published" />
                  <span>Publicado en la web pública</span>
                </label>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn-form-submit">
                  <i class="bi bi-save"></i> Guardar Ciclo
                </button>
                <button type="button" id="ciclo-cancel" class="btn-form-cancel">
                  Cancelar
                </button>
              </div>
            </form>
          </div>
        </div>
      </section>
      <section id="carousel-manager-section">
        <h2
          class="sub-header"
          style="text-align: left; margin-top: 1rem; font-size: 1.5rem"
        >
          <i class="bi bi-images"></i> Gestor de Carrusel (Ingresantes)
        </h2>
        <div class="carousel-grid">
          <div class="carousel-upload-col">
            <h4>Subir Nueva Imagen</h4>
            <p class="carousel-instructions">
              Sube imágenes de <strong>1080x1080 píxeles</strong>.
              <br />
              Te recomendamos usar esta plantilla de Canva:
              <a
                href="https://www.canva.com/design/DAG10VmjnX8/I9YdaWBl2Fdh9KU-OQg0-Q/edit?utm_content=DAG10VmjnX8&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton"
                target="_blank"
                >Abrir Plantilla de Canva</a
              >
            </p>

            <label
              for="carousel-upload-name"
              style="
                font-weight: 600;
                font-size: 0.9rem;
                margin-bottom: 5px;
                display: block;
              "
              >Nombre para el archivo:</label
            >
            <input
              type="text"
              id="carousel-upload-name"
              placeholder="Ej: ingresante-juan-perez"
              style="margin-bottom: 15px"
            />
            <label
              for="carousel-upload-input"
              style="
                font-weight: 600;
                font-size: 0.9rem;
                margin-bottom: 5px;
                display: block;
              "
              >Seleccionar Archivo (1080x1080):</label
            >
            <input
              type="file"
              id="carousel-upload-input"
              accept="image/png, image/jpeg"
            />
            <div id="carousel-preview-container" style="display: none">
              <img id="carousel-preview" alt="Vista previa" />
              <span id="carousel-preview-dims"></span>
            </div>
            <button id="btn-upload-carousel" class="btn-form-submit" disabled>
              <i class="bi bi-upload"></i> Subir Imagen
            </button>
            <div
              id="msg-carousel-upload"
              class="form-message"
              style="margin-top: 10px"
            ></div>
          </div>

          <div class="carousel-list-col">
            <h4>Imágenes Actuales</h4>
            <div id="carousel-list-container">
              <p>Cargando imágenes...</p>
              </div>
          </div>
        </div>
      </section>
      </div>

    <script type="module" src="../js/admin.js"></script>
    <script src="../js/admin-info.js"></script>
  </body>
</html>